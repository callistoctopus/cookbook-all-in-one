=====================================================================
//创建根证书库
keytool -genkey -alias key_basic -keyalg RSA -validity 365 -keystore basic.keystore 

===
//创建客户端证书库
keytool -genkey -alias key_client -keyalg RSA -validity 365 -keystore client.keystore
===
keytool -genkey -alias key_client -keyalg RSA -storetype PKCS12 -keystore client.p12
===

//创建服务器证书库
keytool -genkey -alias key_server -keyalg RSA -validity 365 -keystore server.keystore 

//导出根证书
keytool -export -v -alias key_basic -keystore basic.keystore -file basic.cer 



//服务器发起请求
keytool -certreq -alias key_server -keystore server.keystore -file server_req.csr 

===
//客户端发起请求
keytool -certreq -alias key_client -keystore client.keystore -file client_req.csr
===
keytool -certreq -alias key_client -keystore client.p12 -file client_req.csr
===


//根证书签名服务器请求
keytool -gencert -v -alias key_basic -infile server_req.csr -outfile res_server.cer -keystore basic.keystore

//根证书签名客户端请求
keytool -gencert -v -alias key_basic -infile client_req.csr -outfile res_client.cer -keystore basic.keystore


//服务器添加根证书
keytool -importcert -v -alias key_basic -file basic.cer -keystore server.keystore

===
//客户端添加根证书
keytool -importcert -v -alias key_basic -file basic.cer -keystore client.keystore 
===
keytool -importcert -v -alias key_basic -file basic.cer -keystore client.p12
===

//服务器添加签名文件
keytool -importcert -v -alias key_server -file res_server.cer -keystore server.keystore 

===
//客户端添加签名文件
keytool -importcert -v -alias key_client -file res_client.cer -keystore client.keystore 
===
keytool -importcert -v -alias key_client -file res_client.cer -keystore client.p12
===

===
//客户端导出cer
keytool -export -v -alias key_client -keystore client.keystore -file client.cer
===
keytool -export -v -alias key_client -keystore client.p12 -file client.cer
===

===
//客户端cer创建临时证书库
keytool -importcert -v -alias client_temp -keyalg RSA -keystore client_temp.keystore -file client.cer

//客户端临时证书库导出p12
keytool -importkeystore -v -srcalias client_temp -destalias client -srckeystore client_temp.keystore -destkeystore client.p12  -srcstoretype jks -deststoretype pkcs12 
===

//服务器证书库添加信任客户端证书
keytool -importcert -alias key_client -keystore server.keystore -file client.cer

====================================================================
服务端配置（Tomcat）
server.xml
<Connector port="443" protocol="HTTP/1.1"
    SSLEnabled="true" maxThreads="150" scheme="https" secure="true"
        clientAuth="false" sslProtocol="TLS" keystoreFile="conf/server.keystore" 
    keystorePass="server" truststoreFile="conf/server.keystore" 
    truststorePass="server"/>

web.xml
<login-config> 
    <auth-method>CLIENT-CERT</auth-method> 
    <realm-name>Client Cert Users-only Area</realm-name> 
</login-config> 

<security-constraint> 
    <web-resource-collection > 
        <web-resource-name >SSL</web-resource-name> 
        <url-pattern>/*</url-pattern> 
    </web-resource-collection> 
    <user-data-constraint> 
    <transport-guarantee>CONFIDENTIAL</transport-guarantee> 
    </user-data-constraint> 
</security-constraint>















